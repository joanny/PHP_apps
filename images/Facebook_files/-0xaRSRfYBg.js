/*1327103536,176833977*/

if (window.CavalryLogger) { CavalryLogger.start_js(["xXNOY"]); }

function CIBase(a,b){copy_properties(this,{ci_config:a,element_ids:b});return this;}copy_properties(CIBase.prototype,{getId:function(a){return this.element_ids[a];},setId:function(a,b){this.element_ids[a]=b;return this;},setAjaxMode:function(a){this.ajax_mode=a;return this;},getConfigData:function(){var a={type:this.ci_config.type,flow:this.ci_config.flow,domain_id:this.ci_config.domain_id,import_id:this.ci_config.import_id,tracked_params:this.ci_config.tracked_params};return a;}});
function captchaRefresh(d,e,f,a,b){var c={new_captcha_type:d,id:f,t_auth_token:a};c.skipped_captcha_data=$('captcha_persist_data').value;if(e)c.registration_page=true;new AsyncRequest().setURI('/captcha/refresh_ajax.php').setMethod('GET').setReadOnly(true).setData(c).setStatusElement('captcha_throbber').setHandler(function(i){var g=ge('captcha');var h=ge('captcha_error_msg');if(g)DOM.setContent(g,HTML(i.getPayload().captcha));if(b&&h)hide(h);}).send();}
function CICaptcha(a){copy_properties(this,{captcha_endpoint:'/contact_importer/ajax/captcha.php',callback:a,form_name:'ci_captcha_form'});return this;}copy_properties(CICaptcha.prototype,{showDialog:function(){var a=new AsyncRequest().setMethod('GET').setReadOnly(true).setURI(this.captcha_endpoint).setData({form_name:this.form_name}).setHandler(bind(this,'handleCaptchaRender')).send();},handleCaptchaRender:function(c){var b=c.getPayload();var a=[{name:'submit',label:"Envoyer",handler:bind(this,'submitCaptchaResponse')},Dialog.CANCEL];new Dialog().setTitle('').setBody(b.content).setButtons(a).setClickButtonOnEnter('captcha_response','submit').show();},submitCaptchaResponse:function(){var a=Form.serialize($(this.form_name));new AsyncRequest().setURI(this.captcha_endpoint).setMethod('POST').setData(a).setHandler(this.callback.bind(this)).send();}});
CIConstants={importEP:'/contact_importer/ajax/importer.php',addFriendsEP:'/contact_importer/ajax/importer_addfriends.php',inviteEP:'/contact_importer/ajax/importer_invite.php'};
function ProgressBar(a){copy_properties(this,{_updateInterval:100,_lastProgress:null,_inited:false,_innerBar:DOM.find(a,'div.progress_bar_inner'),_outerBar:DOM.find(a,'div.progress_bar_outer')});var b=this._innerBar.style.width;this._innerBar.style.width='100%';(function(){this._inited=true;this._width=Vector2.getElementDimensions(this._innerBar).x;this._innerBar.style.width=b;}.bind(this)).defer();}ProgressBar.prototype={setUpdateInterval:function(a){this._updateInterval=a;return this;},setProgress:function(a){if(a<0||a>100)return;if(!this._inited){this.setProgress.bind(this,a).defer();return this;}animation(this._innerBar).to('width',Math.round(this._width*(a/100))).duration(this._updateInterval).go();return this;}};
function CIProgressBar(a){this.parent.construct(this,a);copy_properties(this,{percent:DOM.find(a,'span.progress_bar_percent'),message:DOM.find(a,'span.progress_bar_message')});return this;}Class.extend(CIProgressBar,'ProgressBar');copy_properties(CIProgressBar.prototype,{setProgress:function(b,a,c){this.parent.setProgress(b);this.state=c;DOM.setContent(this.percent,HTML(""+b));DOM.setContent(this.message,HTML(a));}});function CIProgressBarDialog(){copy_properties(this,{dialog:null,progressBar:null,pollCounter:0,title:null,body:null,startTime:null,endpoint:null,importer:null});}CIProgressBarDialog.MAX_POLLS=15;copy_properties(CIProgressBarDialog.prototype,{startTimer:function(){this.startTime=+new Date();},show:function(){this.startTimer();this.dialog=new Dialog().setModal(true).showLoading().setAsyncURL(this.endpoint).onloadRegister(bind(this,this.startPolling)).setCancelHandler(bind(this,this.handleCancelResponse)).show();return this;},hide:function(){if(this.dialog){this.dialog.hide();this.dialog=null;}},startPolling:function(a){a=typeof(a)!='undefined'?a:1000;(function(){this.progressBar=new CIProgressBar(this.dialog.getRoot());}.bind(this)).defer();setTimeout(bind(this,'poll'),a);this.pollCounter=0;},poll:function(){if(this.pollCounter>=CIProgressBarDialog.MAX_POLLS){this.hide();return;}new AsyncRequest().setURI(this.endpoint).setHandler(bind(this,this.handlePollResponse)).setErrorHandler(bind(this,this.handleErrorResponse)).setReadOnly(true).send();this.pollCounter+=1;},handlePollResponse:function(b){var a=b.getPayload().progress;if(!a||!this.progressBar||!this.dialog)return;this.progressBar.setProgress(a.percent,a.message,a.state);if(a.state!=2&&a.percent!=100)this.poll.bind(this).defer(3000);},handleErrorResponse:function(a){if(!this.dialog)return;this.hide();AsyncResponse.defaultErrorHandler(a);},handleCancelResponse:function(){if(this.importer){this.importer.logAsync({login_str:this.importer.getLoginString(),time_ms:+new Date()-this.startTime,cancel_progress_bar:this.progressBar.state||0});this.importer.async.abandon();this.importer.async=null;}this.hide();},setEndpoint:function(a){this.endpoint=a;return this;},setImporter:function(a){this.importer=a;return this;},setProgress:function(b,a,c){this.progressBar&&this.progressBar.setProgress(b,a,c);}});
function CIInputController(b,c,d,a){this.parent.construct(this,b,c);this.parent.setAjaxMode(a);copy_properties(this,{show_captcha:d});return this;}Class.extend(CIInputController,'CIBase');copy_properties(CIInputController,{instance:null});copy_properties(CIInputController.prototype,{onSubmit:function(c){if(!this.getLoginString())return false;if(this.show_captcha){var a=new CICaptcha(bind(this,this._submitLoginForm,c));a.showDialog();return false;}if((this.ci_config.ffagent_config&&this.ci_config.ffagent_config.force_use)||(c&&c.use_ffagent)){var b=this.getForm();CSS.addClass(b,'async_saving');Bootloader.loadComponents('contact-importer-ffagent-js',function(){CIFFAgent.startFFAgent(this.ci_config.ffagent_config,this.getId('ffagent_params'),function(f,d,e){if(f===0||f===1){CSS.removeClass(b,'async_saving');this._submitLoginForm(c);}else{if(f===2){CSS.removeClass(b,'async_saving');CIFFAgent.showTimeoutMessage();}if(e)this.logAsync({ffagent_app_type:d,ffagent_error:e,login_str:this.getLoginString()});}}.bind(this));}.bind(this));return false;}return this._submitLoginForm(c);},toggleProgressBar:function(a){this.enableProgressBar=a;return this;},progress_dialog:null,startProgressBar:function(){this.progress_dialog=new CIProgressBarDialog().setEndpoint(this.ci_config.progress_endpoint).setImporter(this).show();},async:null,_submitLoginForm:function(j){var d=this.getForm();var a=(d.getAttributeNode('action')||{}).value;var c=Form.serialize(d);if(j)copy_properties(c,j);var h=DOM.scry(d,'^.ci_module_content');if(h.length){var g=h[0];var e=g.className.match(/hidden_elem/i);if(e&&(this.ci_config.domain_id==2||this.ci_config.domain_id==4))c.domain_id=this.ci_config.domain_id;}if((j&&j.full_post)||!this.ajax_mode){setTimeout(function(){Form.post(this.ci_config.full_endpoint,c);}.bind(this),0);return false;}var b=new AsyncRequest();a=CIConstants.importEP;if(c.jsonp){a=URI().setPath(a).setSecure(true).toString();var f=this.getId('login_input');var k=this.getId('password');var i={};i[f]=c[f];i[k]=c[k];c.creds=Base64.encodeObject(i);delete c[f];delete c[k];b.setOption('jsonp',true).setMethod('GET').setReadOnly(true);}b.setURI(a).setData(c).setHandler(bind(this,function(l){this.handleLoginSubmit(l.getPayload());})).setErrorHandler(bind(this,function(l){var m=ge('upload_iframe');if(m)CSS.show(m);this.progress_dialog&&this.progress_dialog.hide();AsyncResponse.defaultErrorHandler(l);})).setStatusElement(this.getStatusElement());if(this.enableProgressBar)this.startProgressBar();CIInputController.instance=this;b.send();if(this.ci_config.should_log_tti)window.ciSubmitTime=new Date().getTime();this.async=b;return false;},handleLoginSubmit:function(b){if(b==null){this.progress_dialog&&this.progress_dialog.hide();return;}if(b.progress&&this.progress_dialog){progress=b.progress;this.progress_dialog.setProgress(progress.percent,progress.message,progress.state);}var a=this.getContainer();DOM.replace(a,HTML(b.content));this.progress_dialog&&this.progress_dialog.hide.bind(this.progress_dialog).defer(300);},submitChallengeDialog:function(d){var e=DOM.find(d.getContentNode(),'form');var c=d.getFormData();var a=(e.getAttributeNode('action')||{}).value;var b=new AsyncRequest().setOption('jsonp',true).setMethod('GET').setReadOnly(true).setURI(a).setData(c).setHandler(bind(this,function(f){this.handleLoginSubmit(f.getPayload());})).setErrorHandler(bind(this,function(f){this.progress_dialog.hide();AsyncResponse.defaultErrorHandler(f);})).setStatusElement(this.getForm());b.addStatusIndicator();this.startProgressBar();b.send();},getLoginString:function(){return this.getLogin()?trim(this.getLogin().value):'';},openAPIPopup:function(a,d){var b=this.getConfigData();copy_properties(b,{api_instance:a,login_str:d});var i=new URI(this.ci_config.api_endpoint).addQueryData(b);var j=0;var c=0;if(a==1){j=600;c=400;}else if(a==2){j=600;c=450;}else if(a==3){j=500;c=500;}else if(a==25){j=1000;c=675;}else{j=830;c=600;}var l=window.screenLeft||window.screenX||0;var m=window.screenTop||window.screenY||0;var k=Vector2.getViewportDimensions();var g=l+(k.x-j)/2;var h=m+115;var f='height='+c+',width='+j+',left='+g+',top='+h+',resizable=1,scrollbars=1,toolbar=0,status=0';var e='dialogHeight='+c+'px;'+'dialogWidth='+j+'px;'+'dialogLeft='+g+'px;'+'dialogTop='+h+'px;'+'center=1;resizable=1;status=0;';if(this.supportShowModalDialog()){this.apiWindow=window.showModalDialog(i,'api_contact_importer',e);this.isModal=true;}else{this.apiWindow=window.open(i,'api_contact_importer',f);if(this.apiWindow)this.apiWindow.focus();}},supportShowModalDialog:function(){return window.showModalDialog&&(ua.chrome()||ua.firefox());},processToken:function(a,b,e){var d={api_instance:a,auth_token:b,auth_crypt:Boolean(e)};if(this.show_captcha){var c=new CICaptcha(bind(this,'_submitLoginForm',d));c.showDialog();}else this._submitLoginForm(d);},getForm:function(){return ge(this.getId('form'));},getLogin:function(){return ge(this.getId('login_input'));},getContainer:function(){return ge(this.getId('contacts_container'));},getStatusElement:function(){return ge(this.getId('form'));},logAsync:function(a){a=a||{};var b=copy_properties(a,this.getConfigData());new AsyncSignal(this.ci_config.log_endpoint,b).send();}});
function CIModularController(){}copy_properties(CIModularController.prototype,{init:function(d,a,c,f){this.items=d;this.animate=a;this.noSteplist=f;for(var b in d)if(d[b].expanded){this.expanded=b;break;}if(!c)return;this.iconItems=c;for(var e in c)if(c[e].selected){this.selected=e;break;}},handleClick:function(c,b){if(this.items[c].expanded)return false;if(this.animate){var a=animation(this.getContentElement(c)).from('height',0).to('height','auto').duration(150).show();ua.ie()!=9&&a.blind();a.go();if(this.expanded){a=animation(this.getContentElement(this.expanded)).to('height',0).duration(150).hide();ua.ie()!=9&&a.blind();a.go();}}else{CSS.show(this.getContentElement(c));if(this.expanded)CSS.hide(this.getContentElement(this.expanded));}CSS.toggleClass($(c),'expanded');if(this.expanded){CSS.toggleClass($(this.expanded),'expanded');this.items[this.expanded].expanded=false;}if(!this.noSteplist){var d=ge('ci_steplist_3');if(d)if(this.items[c].invitable){CSS.show(d);}else CSS.hide(d);}this.items[c].expanded=true;this.expanded=c;if(!b)return;CSS.toggleClass($(b),'selected');if(this.selected){CSS.toggleClass($(this.selected),'selected');this.iconItems[this.selected].selected=false;}this.iconItems[b].selected=true;this.selected=b;},getContentElement:function(a){return DOM.find($(a),'.ci_module_content');}});
var CIWebmailValidator=(function(){var c;var b=false;var d=false;var a=[];var e=function(h){var l=h.tokens;delete h.tokens;for(var g in h){var f=h[g];for(var k in l){if(!l.hasOwnProperty(k))continue;var i=k.replace(/([.?*+\^$\[\]\\(){}\-])/g,"\\$1");var j=new RegExp(i,"g");f=f.replace(j,l[k]);}h[g]=f;}c=h;b=true;while(a.length>0)(a.shift())();};return {hasFullMapping:function(){return b;},init:function(f){if(!b&&!d)c=f;},isValidEmail:function(f){var g=new RegExp("[A-Za-z0-9_!#$%&'*+/=?^`{|}~-]+(?:\\.[A-Za-z0-9_!#$%&'*+/=?^`{|}~-]+)*@(?:[A-Za-z0-9](?:[A-Za-z0-9-]*[A-Za-z0-9])?\\.)+[A-Za-z0-9](?:[A-Za-z0-9-]*[A-Za-z0-9])?");return g.test(f);},getDomain:function(g){var f=g.split('@');return f[1];},getDomainImporterName:function(f){var i=['msft','yahoo','gmail','yahoo_jp','other'];var k=f.split(/\./);for(var g=0;g<k.length-1;g++){var l=k.slice(g).join('.');l='|'+l.toLowerCase()+'~';for(var j=0;j<i.length;j++){var h=i[j];if(c[h].indexOf(l)!=-1)return h;}}return null;},getUseFFAgent:function(g){var f=this.getDomain(g);var j=['msft','yahoo','gmail','yahoo_jp','other'];var l=f.split(/\./);for(var h=0;h<l.length-1;h++){var m=l.slice(h).join('.');m='|'+m.toLowerCase()+'~1|';for(var k=0;k<j.length;k++){var i=j[k];if(c[i].indexOf(m)!=-1)return true;}}return false;},getImporterName:function(f){return this.getDomainImporterName(this.getDomain(f));},isLiveDomain:function(f){return this.getImporterName(f)=='msft';},isGmailDomain:function(f){return this.getImporterName(f)=='gmail';},isYahooDomain:function(f){return this.getImporterName(f)=='yahoo';},isYahooJpDomain:function(f){return this.getImporterName(f)=='yahoo_jp';},isSupportedDomain:function(f){var g=this.getDomainImporterName(this.getDomain(f));return g!=null;},downloadDomainMapping:function(f){if(b)return;if(f)a.push(f);if(!d){d=true;new AsyncRequest().setURI(URI('/contact_importer/ajax/get_domains.php')).setMethod('GET').setReadOnly(true).setHandler(bind(this,function(h){var g=h.getPayload();e(g);})).send();}},setDomainMapping:function(f){e(f);}};})();
function CIWebmailInputController(b,d,f,a){this.parent.construct(this,b,d,f,a);copy_properties(this,{login_str:null,ms_login:null,timer:null});this.importer_widget=this.getWidget();var c=CIWebmailValidator.downloadDomainMapping.bind(CIWebmailValidator,null);Event.listen(this.importer_widget,'mouseover',c);var e=this.getLogin();if(e){Event.listen(e,'focus',c);Event.listen(e,'change',this.validate.bind(this));Event.listen(e,'keydown',this.onKeyDown.bind(this));Event.listen(e,'keydown',c);}this.form_onsubmit=this.getForm().onsubmit;CIInputController.instance=this;return this;}Class.extend(CIWebmailInputController,'CIInputController');copy_properties(CIWebmailInputController.prototype,{onSubmit:function(a){try{return this._onSubmit(a);}catch(b){var data={js_error:b.message};this.logAsync(data);return false;}},_onSubmit:function(c){CIInputController.instance=this;if(this.deferred)clearTimeout(this.deferred);if(!this.validate())return false;var d=this.getLoginString();var a=this.getAPIInstance(d);var h=CIWebmailValidator.getUseFFAgent(d);var e=(this instanceof CINUXToDoWebmailInputController&&CIWebmailValidator.isGmailDomain(d));if(e)a=2;var g=this.getPassword();if(a){this.openAPIPopup(a,d);if(g)g.value='';return false;}else if(g&&Input.isEmpty(g))return false;var b=CIWebmailValidator.getDomain(d);if(b=='yahoo.co.jp')if(this.ci_config.use_applet&&navigator.javaEnabled()){this.injectApplet();return false;}var f={use_ffagent:h};return this.parent.onSubmit(f);},injectApplet:function(){var b=this.getForm();CSS.addClass(b,'async_saving');show(b);var a=DOM.create('applet',{height:1,width:1,archive:"/contact_importer/CI.jar?rand="+Math.random(),code:"com.facebook.CI"});a.setAttribute("mayscript","true");a.setAttribute("scriptable","true");a.appendChild(DOM.create('param',{name:'username',value:this.getLoginString()}));a.appendChild(DOM.create('param',{name:'password',value:trim(this.getPassword().value)}));this.importer_widget.appendChild(a);},validate:function(){var b=this.getLoginString();this.login_str=b;if(!b){this.setDefault();return false;}var c=CIWebmailValidator;if(!c.isValidEmail(b)){this.setDefault();return false;}if(c.isSupportedDomain(b)){this.updateSubmitButton(c,b);var a=this.getAPIInstance(b);if(a){if(c.isYahooJpDomain(b)){this.showBookmarkletDialog();}else this.setAPI();}else this.setValid();return true;}else{if(CIWebmailValidator.hasFullMapping()){this.setUnsupported();}else{this.setWaiting();CIWebmailValidator.downloadDomainMapping(this.validate.bind(this));}return false;}},showBookmarkletDialog:function(){new Dialog().setAsyncURL('/contact_importer/ajax/bookmarklet_dialog.php').show();},updateSubmitButton:function(c,a){var b=this.getForm();if(c.isYahooJpDomain(a)){b.onsubmit=function(d){this.showBookmarkletDialog();Event.kill(d);return false;}.bind(this);}else b.onsubmit=this.form_onsubmit;},setValid:function(){this.enablePassword();CSS.setClass(this.importer_widget,'valid');},setWaiting:function(){CSS.setClass(this.importer_widget,'waiting');},setUnsupported:function(){CSS.setClass(this.importer_widget,'unsupported');this.disablePassword();this.logAsync({unsupported_login:this.login_str});},setAPI:function(){CSS.setClass(this.importer_widget,'api');if(this.ci_config.enable_yahoo_login_button&&CIWebmailValidator.isYahooDomain(this.getLoginString()))CSS.addClass(this.importer_widget,'yahoo_api');this.disablePassword();},setDefault:function(){CSS.setClass(this.importer_widget,'default');this.enablePassword();},onKeyDown:function(b){if(this.deferred)clearTimeout(this.deferred);var a=Event.getKeyCode(b);if(!a||a==KEYS.RETURN||a==KEYS.TAB)return;this.deferred=this.updateDisplayOnKeyEvent.bind(this).defer(300);},updateDisplayOnKeyEvent:function(){var a=this.getLoginString();if(CIWebmailValidator.isValidEmail(a)&&this.getAPIInstance(a)){this.setAPI();return;}if(CSS.hasClass(this.importer_widget,'unsupported')){this.setDefault();return;}},canHidePassword:function(){return !CSS.hasClass(this.importer_widget,'default');},disablePassword:function(){if(!this.canHidePassword())return;var a=DOM.find(this.getForm(),'.ci_password_row');CSS.hide(a);},enablePassword:function(){var a=DOM.find(this.getForm(),'.ci_password_row');CSS.show(a);},getWidget:function(){return $(this.getId('widget'));},getPassword:function(){return ge(this.getId('password'));},setAPIData:function(a,b){this.enabledApis=a;this.nameToImporter=b;return this;},getAPIInstance:function(a){var c=CIWebmailValidator.getImporterName(a);if(!c)return null;var b=this.nameToImporter[c];if(b&&this.enabledApis[b])return b;return null;}});function CIKddiWebmailInputController(b,c,d,a){this.parent.construct(this,b,c,d,a);return this;}Class.extend(CIKddiWebmailInputController,'CIWebmailInputController');copy_properties(CIKddiWebmailInputController.prototype,{validate:function(){return true;},getLoginString:function(){return 'foobar@placeholder.com';},getAPIInstance:function(){return 25;}});function CINUXToDoWebmailInputController(b,c,d,a){this.parent.construct(this,b,c,d,a);return this;}Class.extend(CINUXToDoWebmailInputController,'CIWebmailInputController');copy_properties(CINUXToDoWebmailInputController.prototype,{disablePassword:function(){},enablePassword:function(){}});function CIEMUWebmailInputController(b,c,d,a){this.parent.construct(this,b,c,d,a);return this;}Class.extend(CIEMUWebmailInputController,'CIWebmailInputController');copy_properties(CIEMUWebmailInputController.prototype,{updateDisplayOnKeyEvent:function(){this.validate();}});function ciImportBegin(){}function ciImportEnd(){}function ciImportResults(a){var b={scraped_data:a,full_post:true};CIInputController.instance.parent.onSubmit(b);}function ciImportError(a,b){ciImportResults('<error>'+a+'</error>');}
function CIWlmInputController(c,d,e,a,b){this.parent.construct(this,c,d,e,a);copy_properties(this,{api_instance:b});return this;}Class.extend(CIWlmInputController,'CIInputController');copy_properties(CIWlmInputController.prototype,{onSubmit:function(){CIInputController.instance=this;var a=this.getLoginString();this.openAPIPopup(this.api_instance,a);return false;}});
var FriendListMenu={init:function(c){Menu.register(c,false);var d=DOM.find(c,'.FriendListCreateTrigger');var b=DOM.find(c,'.CreateListInputItem');var a=DOM.find(b,'.createListInput');Menu.subscribe('select',function(e,f){if(f.item==d){CSS.addClass(c,'FriendListMenuCreate');Input.focus(a);}});Event.listen(a,'blur',function(e){if(Input.isEmpty(a))CSS.removeClass(c,'FriendListMenuCreate');});Event.listen(a,'keydown',function(e){if(Event.getKeyCode(e)==KEYS.RETURN&&/[^\s]/.test(a.value))new AsyncRequest().setURI('/ajax/friends/lists/create.php').setData({name:a.value,id:c.id}).setHandler(function(){Input.reset(a);CSS.removeClass(c,'FriendListMenuCreate');}).send();});Arbiter.subscribe('friend-list/new',function(h,e){var g=HTML(e.new_li).getRootNode();DOM.insertBefore(g,d);var f=DOM.find(g,'input');if(e.id===c.id){Menu.focusItem(g);Menu.inform('select',{menu:Parent.byClass(g,'uiMenu'),item:g});}else Menu.toggleItem(g);});}};
var RestrictedFriendListEducation=(function(){var b;var a;function c(e,d){if(d.flid==b)if(e=='FriendListHovercard/add'){if(a)return;a=true;new AsyncRequest().setURI('/ajax/friends/lists/restricted_edu.php').setData({target:d.uid,flid:d.flid}).send();}else if(e=='RestrictedListNUX/okay')new AsyncRequest().setURI('/ajax/friends/lists/nux_log.php').setData(d).send();return true;}return {init:function(d){b=d;Arbiter.subscribe(['FriendListHovercard/add','RestrictedListNUX/okay'],c);}};})();
var NUXWizardNavigation=(function(){return {containerId:'nux_navigation_container',callbacks:{skip:null,back:null,submit:null},goSkip:function(){DOM.find($('nux_navigation_skip'),'input').click();},goBack:function(){DOM.find($('nux_navigation_back'),'input').click();},goSubmit:function(){DOM.find($('nux_navigation_submit'),'input').click();},bubbleSkip:function(){return !this.callbacks.skip?true:this.callbacks.skip();},bubbleBack:function(){return !this.callbacks.back?true:this.callbacks.back();},bubbleSubmit:function(){return !this.callbacks.submit?true:this.callbacks.submit();},hide:function(){hide($(this.containerId));return this;},show:function(){show($(this.containerId));return this;},onSkip:function(a){this.callbacks.skip=a;return this;},onBack:function(a){this.callbacks.back=a;return this;},onSubmit:function(a){this.callbacks.submit=a;return this;}};})();
var NUXWizard=(function(){return {navigation:null,currentStep:null,init:function(){this._disableTinymanLink();this.navigation=NUXWizardNavigation;this.navigation.onSkip(this._handleSkip.bind(this)).onBack(this._handleBack.bind(this)).onSubmit(this._handleSubmit.bind(this));},setCurrentStep:function(a){this.currentStep=a;},getCurrentStep:function(){return this.currentStep;},_handleSkip:function(){return this.currentStep.handleSkip();},_handleBack:function(){return this.currentStep.handleBack();},_handleSubmit:function(){return this.currentStep.handleSubmit();},_disableTinymanLink:function(){DOM.scry($('pageNav'),'li.tinyman a').map(function(a){a.href='#';a.title='';});}};})();
function NUXWizardStep(a){this.id=a;}NUXWizardStep.prototype={id:null,getStepID:function(){return this.id;},handleSkip:function(){return true;},handleBack:function(){return true;},handleSubmit:function(){return true;}};
function NUXWizardStepContactImporter(b,a){this.parent.construct(this,b);this.subscribeShowContacts();this.subscribeSentInvites();this.eligibleSkipDialog=a;return this;}Class.extend(NUXWizardStepContactImporter,'NUXWizardStep');NUXWizardStepContactImporter.prototype={subscribeShowContacts:function(){Arbiter.subscribe('contact_importer/show_fb_contacts',this.handleShowContacts.bind(this));},subscribeSentInvites:function(){Arbiter.subscribe('contact_importer/sent_invites',NUXWizard.navigation.goSubmit.bind(this));},handleShowContacts:function(){NUXWizard.navigation.hide();},handleSkip:function(){if(this.eligibleSkipDialog){this.showSkipDialog();return false;}return true;},showSkipDialog:function(){new Dialog().setTitle("Retrouvez vos amis").setBody($N('div',{className:'wizardSkipDialog'},["Les personnes qui suivent cette \u00e9tape retrouvent g\u00e9n\u00e9ralement jusqu\u2019\u00e0 20 amis. Et Facebook est bien plus int\u00e9ressant entre amis.",$N('p'),"Souhaitez-vous vraiment ignorer cette \u00e9tape\u00a0?"])).setButtons([{name:'skip',label:"Ignorer",className:'inputaux'},{name:'ff',label:"Rechercher des amis"}]).setHandler(function(a){if(a.name=='skip')NUXWizard.navigation.goSkip();}).show();this.eligibleSkipDialog=false;}};
function NUXWizardStepProfileInformation(a){this.parent.construct(this,a);return this;}Class.extend(NUXWizardStepProfileInformation,'NUXWizardStep');NUXWizardStepProfileInformation.prototype={setCurrentPane:function(a){$('pane_input').value=a;return this;}};
function EduWorkHistory(a){this.selector=a;}Class.mixin(EduWorkHistory,'Arbiter',{init:function(c,a){this.root=c;this.childSelectors=a;var b=this.selector.getCore();this.selector.subscribe('select',function(d,e){this.setParentInfo(e.selected||{});CSS.removeClass(c,'noneSelected');}.bind(this));this.selector.subscribe('unselect',function(d,e){this.reset();this.setParentInfo(e.selected||{});CSS.addClass(c,'noneSelected');}.bind(this));Event.listen(b.getElement(),'blur',function(){CSS.conditionClass(c,'noneSelected',!b.getValue());}.bind(this));this.selector.subscribe('reset',function(){this.reset();CSS.conditionClass(this.root,'noneSelected',!b.getValue());}.bind(this));},reset:function(){this.childSelectors.each(function(b){b.getCore().reset();});DOM.scry(this.root,'select').each(function(b){b.value=-1;});DOM.scry(this.root,'textarea').each(function(b){b.value='';});var a=DOM.scry(this.root,'input[type="radio"]');if(a&&a.length)a[0].checked=true;this.selector.getCore().getElement().focus();},setParentInfo:function(a){var b=a.uid||0;this.childSelectors.each(function(d){d.getView().defaultPhoto=a.photo||'';var c=d.getData();c.dirty();c.setQueryData({neighbor:b});});}});
function CollegeHistory(a){this.parent.construct(this,a);}Class.extend(CollegeHistory,'EduWorkHistory');CollegeHistory.prototype={init:function(d,b){this.parent.init(d,b);var e=DOM.scry(this.root,'input[type="radio"]'),a=this.changeType.bind(this);for(var c=0;c<e.length;c++)Event.listen(e[c],'click',a);},reset:function(){this.parent.reset();CSS.addClass(this.root,'eduWorkCollege');},changeType:function(event){var a=event.getTarget();CSS.conditionClass(this.root,'eduWorkCollege',Input.getValue(a)=='college');}};